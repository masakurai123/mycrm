<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ミニMOTHER風ゲーム</title>
  <style>
    body { margin: 0; background: #222; overflow: hidden; }
    #game {
      width: 320px; height: 240px;
      background: #88c070;
      position: relative;
      margin: 20px auto;
      border: 2px solid #fff;
      image-rendering: pixelated;
    }
    .sprite {
      width: 32px; height: 32px;
      position: absolute;
    }
    #player { background: red; }
    #npc { background: yellow; top: 100px; left: 160px; }

    #dialogue {
      position: absolute;
      bottom: 0; left: 0;
      width: 100%;
      background: #000;
      color: white;
      font-family: monospace;
      font-size: 14px;
      padding: 8px;
      display: none;
    }
  </style>
</head>
<body>
  <div id="game">
    <div id="player" class="sprite"></div>
    <div id="npc" class="sprite"></div>
    <div id="dialogue">こんにちは！ここはサンプル村だよ。</div>
  </div>

  <script>
    const player = document.getElementById("player");
    const npc = document.getElementById("npc");
    const dialogue = document.getElementById("dialogue");

    let x = 50, y = 50;
    const speed = 4;

    function updatePlayerPosition() {
      player.style.left = x + "px";
      player.style.top = y + "px";
    }

    function isNearNPC() {
      const px = x, py = y;
      const nx = parseInt(npc.style.left), ny = parseInt(npc.style.top);
      const distX = Math.abs(px - nx);
      const distY = Math.abs(py - ny);
      return distX < 32 && distY < 32;
    }

    document.addEventListener("keydown", e => {
      if (dialogue.style.display === "block" && e.key === " ") {
        dialogue.style.display = "none";
        return;
      }

      switch(e.key) {
        case "ArrowUp": y -= speed; break;
        case "ArrowDown": y += speed; break;
        case "ArrowLeft": x -= speed; break;
        case "ArrowRight": x += speed; break;
        case " ": // スペースキーで会話
          if (isNearNPC()) {
            dialogue.style.display = "block";
          }
          break;
      }
      updatePlayerPosition();
    });

    updatePlayerPosition();
  </script>
</body>
</html>
